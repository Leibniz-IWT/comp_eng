import numpy as np
from scipy.interpolate import interp1d

alphas = np.array([-3.14159265, -3.11001886, -3.07844506, -3.04687127, -3.01529747,
        -2.98372368, -2.95214988, -2.92057608, -2.88900229, -2.85742849,
        -2.8258547 , -2.7942809 , -2.76270711, -2.73113331, -2.69955952,
        -2.66798572, -2.63641193, -2.60483813, -2.57326433, -2.54169054,
        -2.51011674, -2.47854295, -2.44696915, -2.41539536, -2.38382156,
        -2.35224777, -2.32067397, -2.28910017, -2.25752638, -2.22595258,
        -2.19437879, -2.16280499, -2.1312312 , -2.0996574 , -2.06808361,
        -2.03650981, -2.00493602, -1.97336222, -1.94178842, -1.91021463,
        -1.87864083, -1.84706704, -1.81549324, -1.78391945, -1.75234565,
        -1.72077186, -1.68919806, -1.65762426, -1.62605047, -1.59447667,
        -1.56290288, -1.53132908, -1.49975529, -1.46818149, -1.4366077 ,
        -1.4050339 , -1.3734601 , -1.34188631, -1.31031251, -1.27873872,
        -1.24716492, -1.21559113, -1.18401733, -1.15244354, -1.12086974,
        -1.08929595, -1.05772215, -1.02614835, -0.99457456, -0.96300076,
        -0.93142697, -0.89985317, -0.86827938, -0.83670558, -0.80513179,
        -0.77355799, -0.74198419, -0.7104104 , -0.6788366 , -0.64726281,
        -0.61568901, -0.58411522, -0.55254142, -0.52096763, -0.48939383,
        -0.45782003, -0.42624624, -0.39467244, -0.36309865, -0.33152485,
        -0.29995106, -0.26837726, -0.23680347, -0.20522967, -0.17365588,
        -0.14208208, -0.11050828, -0.07893449, -0.04736069, -0.0157869 ,
         0.0157869 ,  0.04736069,  0.07893449,  0.11050828,  0.14208208,
         0.17365588,  0.20522967,  0.23680347,  0.26837726,  0.29995106,
         0.33152485,  0.36309865,  0.39467244,  0.42624624,  0.45782003,
         0.48939383,  0.52096763,  0.55254142,  0.58411522,  0.61568901,
         0.64726281,  0.6788366 ,  0.7104104 ,  0.74198419,  0.77355799,
         0.80513179,  0.83670558,  0.86827938,  0.89985317,  0.93142697,
         0.96300076,  0.99457456,  1.02614835,  1.05772215,  1.08929595,
         1.12086974,  1.15244354,  1.18401733,  1.21559113,  1.24716492,
         1.27873872,  1.31031251,  1.34188631,  1.3734601 ,  1.4050339 ,
         1.4366077 ,  1.46818149,  1.49975529,  1.53132908,  1.56290288,
         1.59447667,  1.62605047,  1.65762426,  1.68919806,  1.72077186,
         1.75234565,  1.78391945,  1.81549324,  1.84706704,  1.87864083,
         1.91021463,  1.94178842,  1.97336222,  2.00493602,  2.03650981,
         2.06808361,  2.0996574 ,  2.1312312 ,  2.16280499,  2.19437879,
         2.22595258,  2.25752638,  2.28910017,  2.32067397,  2.35224777,
         2.38382156,  2.41539536,  2.44696915,  2.47854295,  2.51011674,
         2.54169054,  2.57326433,  2.60483813,  2.63641193,  2.66798572,
         2.69955952,  2.73113331,  2.76270711,  2.7942809 ,  2.8258547 ,
         2.85742849,  2.88900229,  2.92057608,  2.95214988,  2.98372368,
         3.01529747,  3.04687127,  3.07844506,  3.11001886,  3.14159265])

noisy_drag = np.array([0.99013872, 1.03080785, 1.07600962, 1.13518782, 1.03743482,
        1.2193008 , 1.1860463 , 1.18058094, 1.29651762, 1.3217911 ,
        1.27221778, 1.40784771, 1.33033807, 1.3881383 , 1.35453941,
        1.46344567, 1.49834124, 1.47254901, 1.59631291, 1.52902131,
        1.51570375, 1.68723239, 1.62218869, 1.60754703, 1.72121936,
        1.67086465, 1.69632074, 1.78629345, 1.75067322, 1.77889575,
        1.84623871, 1.84156948, 1.78692099, 1.88995122, 1.89929099,
        1.88790819, 1.92050866, 2.01691131, 1.92503112, 1.82942594,
        1.81822164, 1.93588132, 1.98382771, 1.96230933, 1.95734172,
        2.01558838, 1.98207694, 1.90174232, 1.98373416, 2.03301347,
        2.02307722, 1.90502409, 1.91600658, 2.03660978, 1.9884431 ,
        2.06296207, 1.90737249, 1.95588666, 1.99345326, 2.07051728,
        1.85657206, 2.07253327, 1.8497666 , 1.94241991, 1.91663861,
        1.9039761 , 1.87711531, 1.90209411, 1.79253225, 1.84725474,
        1.80223337, 1.77697264, 1.75477981, 1.76922315, 1.74268624,
        1.75702083, 1.64359686, 1.6493251 , 1.65457921, 1.66167609,
        1.55485036, 1.59833668, 1.55668152, 1.56939082, 1.35670913,
        1.5483118 , 1.43538854, 1.46807781, 1.32935023, 1.32103799,
        1.30588401, 1.33237489, 1.26952008, 1.30016146, 1.22297973,
        1.12310039, 1.12642911, 1.00339588, 1.08911872, 1.02746943,
        1.00384059, 1.10642959, 1.08589054, 1.03312887, 1.1544066 ,
        1.096678  , 1.23173248, 1.12393818, 1.30395082, 1.30610368,
        1.34034174, 1.44116262, 1.31962248, 1.453765  , 1.46645821,
        1.46037477, 1.46759171, 1.56310567, 1.54088041, 1.56663369,
        1.62175312, 1.6961094 , 1.6117557 , 1.69349526, 1.70135925,
        1.7473313 , 1.79256675, 1.82621975, 1.72461014, 1.77067692,
        1.80492061, 1.79519099, 1.85455517, 1.86107501, 1.93944214,
        1.87344108, 1.99174342, 1.92323455, 1.85233207, 1.95922962,
        1.88790629, 1.92685249, 1.96190042, 1.98683625, 1.94240751,
        2.07703275, 2.04316607, 2.04315794, 1.98038668, 2.10188267,
        1.98989158, 2.01792438, 1.96689617, 1.99338896, 1.95775888,
        1.85898554, 2.02307091, 1.9356096 , 1.90605196, 1.9214363 ,
        1.97384027, 1.97978862, 1.93528473, 1.87856151, 1.9501526 ,
        1.89910188, 1.84747499, 1.88462388, 1.8544776 , 1.86244038,
        1.74998305, 1.75603144, 1.70219887, 1.72810566, 1.61812328,
        1.65111809, 1.72310513, 1.61172047, 1.62865505, 1.50150096,
        1.61392794, 1.59488845, 1.59939366, 1.57149827, 1.46233655,
        1.38538611, 1.38813071, 1.3633797 , 1.27855668, 1.28216259,
        1.27178558, 1.21481144, 1.24494632, 1.20786821, 1.01248224,
        1.07825914, 1.02224561, 0.95432151, 0.97789558, 0.98988421])

# Valves:
valves, noisy_thrust_main, noisy_thrust_rot = (np.array([0.        , 0.01010101, 0.02020202, 0.03030303, 0.04040404,
        0.05050505, 0.06060606, 0.07070707, 0.08080808, 0.09090909,
        0.1010101 , 0.11111111, 0.12121212, 0.13131313, 0.14141414,
        0.15151515, 0.16161616, 0.17171717, 0.18181818, 0.19191919,
        0.2020202 , 0.21212121, 0.22222222, 0.23232323, 0.24242424,
        0.25252525, 0.26262626, 0.27272727, 0.28282828, 0.29292929,
        0.3030303 , 0.31313131, 0.32323232, 0.33333333, 0.34343434,
        0.35353535, 0.36363636, 0.37373737, 0.38383838, 0.39393939,
        0.4040404 , 0.41414141, 0.42424242, 0.43434343, 0.44444444,
        0.45454545, 0.46464646, 0.47474747, 0.48484848, 0.49494949,
        0.50505051, 0.51515152, 0.52525253, 0.53535354, 0.54545455,
        0.55555556, 0.56565657, 0.57575758, 0.58585859, 0.5959596 ,
        0.60606061, 0.61616162, 0.62626263, 0.63636364, 0.64646465,
        0.65656566, 0.66666667, 0.67676768, 0.68686869, 0.6969697 ,
        0.70707071, 0.71717172, 0.72727273, 0.73737374, 0.74747475,
        0.75757576, 0.76767677, 0.77777778, 0.78787879, 0.7979798 ,
        0.80808081, 0.81818182, 0.82828283, 0.83838384, 0.84848485,
        0.85858586, 0.86868687, 0.87878788, 0.88888889, 0.8989899 ,
        0.90909091, 0.91919192, 0.92929293, 0.93939394, 0.94949495,
        0.95959596, 0.96969697, 0.97979798, 0.98989899, 1.        ]),
 4*np.array([0.00000000e+00, 2.59956429e-01, 1.03097063e+00, 8.18770347e-01,
        9.84518335e-01, 2.18884724e+00, 1.46833526e+00, 2.23447133e-01,
        2.55804750e+00, 8.39474820e-01, 1.28949216e+00, 1.70841623e+00,
        9.87704158e-01, 2.26042718e-02, 2.50161443e+00, 4.86636951e-01,
        1.49626220e+00, 1.00194292e-02, 1.27690237e+00, 2.79601090e+00,
        2.48906150e+00, 1.40242715e+00, 6.56800447e-01, 2.76424118e+00,
        3.82679909e+00, 3.75548871e+00, 3.38422977e+00, 4.12531746e+00,
        5.67549418e+00, 6.71985765e+00, 4.55939582e+00, 5.69131837e+00,
        5.66645932e+00, 4.66016665e+00, 8.14930142e+00, 7.03291681e+00,
        8.32297244e+00, 7.69804644e+00, 8.30250652e+00, 9.41942365e+00,
        9.37759170e+00, 1.22684915e+01, 1.10159716e+01, 1.33054810e+01,
        1.27852396e+01, 1.50699010e+01, 1.32233816e+01, 1.55270903e+01,
        1.69664629e+01, 1.92579694e+01, 1.85817016e+01, 1.92545452e+01,
        2.18930083e+01, 2.07848746e+01, 2.02698132e+01, 2.27777883e+01,
        2.48576286e+01, 2.55758458e+01, 2.39399949e+01, 2.71838202e+01,
        2.99839352e+01, 2.83671124e+01, 3.12806570e+01, 3.22526047e+01,
        3.59876620e+01, 3.51412045e+01, 3.60712668e+01, 3.75584986e+01,
        4.05384431e+01, 4.03752932e+01, 4.12614357e+01, 4.37213766e+01,
        4.74351939e+01, 4.61166002e+01, 4.90647476e+01, 4.93684327e+01,
        5.15075850e+01, 5.33296674e+01, 5.54414289e+01, 5.58088732e+01,
        5.90822013e+01, 6.00167180e+01, 6.09243973e+01, 6.44592193e+01,
        6.49449690e+01, 6.87561553e+01, 7.12731319e+01, 7.28366874e+01,
        7.49000705e+01, 7.73441774e+01, 7.82122184e+01, 8.16516587e+01,
        8.25040923e+01, 8.57878800e+01, 8.78797778e+01, 8.91229234e+01,
        9.35931067e+01, 9.53973246e+01, 9.60745296e+01, 9.94333086e+01]),
 np.array([0.        , 0.05353435, 0.03416423, 0.07371964, 0.01209497,
        0.05906377, 0.06918732, 0.05454847, 0.07629614, 0.12555869,
        0.11657698, 0.14944782, 0.13998306, 0.23517583, 0.26204653,
        0.29041991, 0.32984686, 0.41425255, 0.37715244, 0.44288476,
        0.34340417, 0.51537818, 0.51737052, 0.59763949, 0.62120981,
        0.58291104, 0.72024558, 0.67873301, 0.76948469, 0.81222706,
        0.77929375, 0.85195165, 0.94860602, 0.78828607, 1.08317803,
        1.09963977, 1.11407665, 1.16964055, 1.15652173, 1.18446076,
        1.3494832 , 1.31114168, 1.4787091 , 1.47153044, 1.52091518,
        1.53234552, 1.56721248, 1.64295743, 1.74108024, 1.80151579,
        1.84969111, 1.91627554, 1.92330823, 1.93597267, 1.94912859,
        2.0243809 , 2.18714562, 2.16847779, 2.22555889, 2.24422622,
        2.37080854, 2.44231354, 2.47568584, 2.49948543, 2.5841666 ,
        2.72348794, 2.72029361, 2.73818934, 2.83115356, 2.96591129,
        2.99336021, 3.09387837, 3.05568126, 3.21624283, 3.30390976,
        3.28365189, 3.37246576, 3.32982963, 3.51150049, 3.47573834,
        3.55440003, 3.78897895, 3.8431509 , 3.82649508, 3.92617609,
        3.95151508, 4.11382141, 4.07053972, 4.22565206, 4.22065507,
        4.29438748, 4.31828519, 4.4025181 , 4.50408695, 4.57578945,
        4.73994438, 4.76983736, 4.90410409, 4.83052806, 5.06030131]))

# Hidden functions for station model calculationsq
drag_interp = interp1d(alphas, noisy_drag, kind='linear', fill_value='extrapolate')
thrust_main_interp = interp1d(valves, noisy_thrust_main, kind='linear', bounds_error=False, fill_value=(0, noisy_thrust_main[-1]))
thrust_rot_interp = interp1d(valves, noisy_thrust_rot, kind='linear', bounds_error=False, fill_value=(0, noisy_thrust_rot[-1]))

# Sub task 1 solution tests

import numpy as np

def test_solutions(drag_interp , thrust_main_interp, thrust_rot_interp):
    # Test data for validation:
    alphas = np.linspace(-np.pi, np.pi, 200)
    valves = np.linspace(0, 1, 100)
    # Clean data:
    drag, thrust_main, thrust_rot = (np.array([1.        , 1.03156855, 1.06310563, 1.09457981, 1.12595971,
            1.15721404, 1.18831167, 1.21922158, 1.24991296, 1.28035523,
            1.31051803, 1.3403713 , 1.36988529, 1.39903056, 1.42777807,
            1.45609916, 1.4839656 , 1.51134962, 1.53822391, 1.56456168,
            1.59033669, 1.61552324, 1.64009622, 1.66403114, 1.68730414,
            1.70989202, 1.73177227, 1.75292306, 1.77332333, 1.79295273,
            1.8117917 , 1.82982146, 1.84702403, 1.86338228, 1.87887988,
            1.8935014 , 1.90723225, 1.92005876, 1.93196813, 1.94294849,
            1.95298891, 1.96207936, 1.9702108 , 1.9773751 , 1.98356514,
            1.98877473, 1.9929987 , 1.99623282, 1.99847388, 1.99971963,
            1.99996885, 1.99922127, 1.99747765, 1.99473972, 1.99101021,
            1.98629284, 1.98059231, 1.97391431, 1.96626549, 1.95765347,
            1.94808684, 1.93757514, 1.92612885, 1.91375937, 1.90047903,
            1.88630108, 1.87123964, 1.85530974, 1.83852724, 1.82090888,
            1.80247221, 1.78323563, 1.7632183 , 1.74244018, 1.72092198,
            1.69868515, 1.67575185, 1.65214495, 1.62788797, 1.60300511,
            1.57752115, 1.55146151, 1.52485216, 1.49771963, 1.47009096,
            1.44199369, 1.41345583, 1.38450584, 1.35517255, 1.32548523,
            1.29547345, 1.26516714, 1.2345965 , 1.20379202, 1.17278439,
            1.14160452, 1.1102835 , 1.07885255, 1.04734299, 1.01578624,
            1.01578624, 1.04734299, 1.07885255, 1.1102835 , 1.14160452,
            1.17278439, 1.20379202, 1.2345965 , 1.26516714, 1.29547345,
            1.32548523, 1.35517255, 1.38450584, 1.41345583, 1.44199369,
            1.47009096, 1.49771963, 1.52485216, 1.55146151, 1.57752115,
            1.60300511, 1.62788797, 1.65214495, 1.67575185, 1.69868515,
            1.72092198, 1.74244018, 1.7632183 , 1.78323563, 1.80247221,
            1.82090888, 1.83852724, 1.85530974, 1.87123964, 1.88630108,
            1.90047903, 1.91375937, 1.92612885, 1.93757514, 1.94808684,
            1.95765347, 1.96626549, 1.97391431, 1.98059231, 1.98629284,
            1.99101021, 1.99473972, 1.99747765, 1.99922127, 1.99996885,
            1.99971963, 1.99847388, 1.99623282, 1.9929987 , 1.98877473,
            1.98356514, 1.9773751 , 1.9702108 , 1.96207936, 1.95298891,
            1.94294849, 1.93196813, 1.92005876, 1.90723225, 1.8935014 ,
            1.87887988, 1.86338228, 1.84702403, 1.82982146, 1.8117917 ,
            1.79295273, 1.77332333, 1.75292306, 1.73177227, 1.70989202,
            1.68730414, 1.66403114, 1.64009622, 1.61552324, 1.59033669,
            1.56456168, 1.53822391, 1.51134962, 1.4839656 , 1.45609916,
            1.42777807, 1.39903056, 1.36988529, 1.3403713 , 1.31051803,
            1.28035523, 1.24991296, 1.21922158, 1.18831167, 1.15721404,
            1.12595971, 1.09457981, 1.06310563, 1.03156855, 1.        ]),
     4*np.array([0.00000000e+00, 1.02544415e-03, 5.80078812e-03, 1.59850924e-02,
            3.28142129e-02, 5.73240709e-02, 9.04253377e-02, 1.32940441e-01,
            1.85625220e-01, 2.49182929e-01, 3.24273914e-01, 4.11522634e-01,
            5.11522956e-01, 6.24842260e-01, 7.52024696e-01, 8.93593829e-01,
            1.05005481e+00, 1.22189621e+00, 1.40959151e+00, 1.61360049e+00,
            1.83437027e+00, 2.07233638e+00, 2.32792356e+00, 2.60154656e+00,
            2.89361081e+00, 3.20451298e+00, 3.53464159e+00, 3.88437745e+00,
            4.25409410e+00, 4.64415823e+00, 5.05493005e+00, 5.48676359e+00,
            5.94000703e+00, 6.41500299e+00, 6.91208876e+00, 7.43159655e+00,
            7.97385374e+00, 8.53918306e+00, 9.12790276e+00, 9.74032686e+00,
            1.03767652e+01, 1.10375239e+01, 1.17229048e+01, 1.24332067e+01,
            1.31687243e+01, 1.39297492e+01, 1.47165697e+01, 1.55294709e+01,
            1.63687346e+01, 1.72346399e+01, 1.81274629e+01, 1.90474768e+01,
            1.99949523e+01, 2.09701573e+01, 2.19733571e+01, 2.30048146e+01,
            2.40647903e+01, 2.51535422e+01, 2.62713262e+01, 2.74183959e+01,
            2.85950025e+01, 2.98013955e+01, 3.10378219e+01, 3.23045270e+01,
            3.36017540e+01, 3.49297442e+01, 3.62887369e+01, 3.76789698e+01,
            3.91006786e+01, 4.05540974e+01, 4.20394585e+01, 4.35569925e+01,
            4.51069284e+01, 4.66894936e+01, 4.83049140e+01, 4.99534137e+01,
            5.16352155e+01, 5.33505408e+01, 5.50996094e+01, 5.68826397e+01,
            5.86998486e+01, 6.05514518e+01, 6.24376637e+01, 6.43586972e+01,
            6.63147640e+01, 6.83060746e+01, 7.03328379e+01, 7.23952621e+01,
            7.44935539e+01, 7.66279188e+01, 7.87985611e+01, 8.10056842e+01,
            8.32494900e+01, 8.55301798e+01, 8.78479533e+01, 9.02030094e+01,
            9.25955458e+01, 9.50257594e+01, 9.74938459e+01, 1.00000000e+02]),
     np.array([0.        , 0.00507595, 0.01435695, 0.0263754 , 0.04060759,
        0.05675083, 0.0746009 , 0.09400788, 0.1148556 , 0.13705061,
        0.16051559, 0.18518519, 0.21100322, 0.23792071, 0.26589445,
        0.29488596, 0.32486071, 0.35578743, 0.38763767, 0.42038539,
        0.45400664, 0.48847929, 0.5237828 , 0.55989806, 0.59680723,
        0.63449357, 0.67294138, 0.71213587, 0.75206306, 0.79270977,
        0.83406346, 0.87611225, 0.91884484, 0.96225045, 1.0063188 ,
        1.05104008, 1.09640489, 1.14240422, 1.18902944, 1.23627226,
        1.2841247 , 1.3325791 , 1.38162807, 1.43126449, 1.48148148,
        1.53227241, 1.58363087, 1.63555066, 1.68802575, 1.74105036,
        1.79461882, 1.84872569, 1.90336565, 1.95853356, 2.0142244 ,
        2.07043331, 2.12715557, 2.18438656, 2.24212181, 2.30035694,
        2.35908771, 2.41830996, 2.47801965, 2.53821284, 2.59888566,
        2.66003437, 2.72165527, 2.78374479, 2.8462994 , 2.90931569,
        2.97279028, 3.0367199 , 3.10110133, 3.16593142, 3.23120708,
        3.2969253 , 3.36308312, 3.42967763, 3.49670598, 3.5641654 ,
        3.63205313, 3.7003665 , 3.76910287, 3.83825965, 3.90783431,
        3.97782434, 4.0482273 , 4.11904078, 4.19026241, 4.26188986,
        4.33392086, 4.40635315, 4.47918452, 4.55241279, 4.62603584,
        4.70005154, 4.77445783, 4.84925267, 4.92443405, 5.        ]))

    # L2-norm errors
    drag_error = np.linalg.norm(drag_interp(alphas) - drag)
    thrust_main_error = np.linalg.norm(thrust_main_interp(valves) - thrust_main)
    thrust_rot_error = np.linalg.norm(thrust_rot_interp(valves) - thrust_rot)
    print(f'Drag Factor L2-norm error: {drag_error:.6f}')
    print(f'Main Thrust L2-norm error: {thrust_main_error:.6f}')
    print(f'Rotational Thrust L2-norm error: {thrust_rot_error:.6f}')
    if (drag_error < 0.05) and (thrust_main_error < 0.05) and (thrust_rot_error < 0.05):
        print('Success! All tests passed.')
    else:
        print('Some tests failed. Please check your implementations.')
